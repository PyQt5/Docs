<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
<!-- simplebrowser.qdoc -->
  <title>WebEngine Widgets Simple Browser Example | Qt WebEngine 5.15.0</title>
  <link rel="stylesheet" type="text/css" href="style/offline-simple.css" />
  <script type="text/javascript">
    document.getElementsByTagName("link").item(0).setAttribute("href", "style/offline.css");
    // loading style sheet breaks anchors that were jumped to before
    // so force jumping to anchor again
    setTimeout(function() {
        var anchor = location.hash;
        // need to jump to different anchor first (e.g. none)
        location.hash = "#";
        setTimeout(function() {
            location.hash = anchor;
        }, 0);
    }, 0);
  </script>
</head>
<body>
<div class="header" id="qtdocheader">
    <div class="main">
    <div class="main-rounded">
        <div class="navigationbar">
        <ul>
<li><a href="../qtdoc/index.html">Qt 5.15</a></li>
<li><a href="qtwebengine-index.html">Qt WebEngine</a></li>
<li>WebEngine Widgets Simple Browser Example</li>
<li id="buildversion"><a href="qtwebengine-index.html">Qt 5.15.0 Reference Documentation</a></li>
    </ul>
    </div>
</div>
<div class="content">
<div class="line">
<div class="content mainContent">
<div class="sidebar">
<div class="toc">
<h3><a name="toc">Contents</a></h3>
<ul>
<li class="level1"><a href="#running-the-example">Running the Example</a></li>
<li class="level1"><a href="#class-hierarchy">Class Hierarchy</a></li>
<li class="level1"><a href="#creating-the-browser-main-window">Creating the Browser Main Window</a></li>
<li class="level1"><a href="#creating-tabs">Creating Tabs</a></li>
<li class="level1"><a href="#implementing-webview-functionality">Implementing WebView Functionality</a></li>
<li class="level2"><a href="#displaying-error-messages">Displaying Error Messages</a></li>
<li class="level2"><a href="#managing-webwindows">Managing WebWindows</a></li>
<li class="level2"><a href="#adding-context-menu-items">Adding Context Menu Items</a></li>
<li class="level1"><a href="#implementing-webpage-functionality">Implementing WebPage Functionality</a></li>
<li class="level1"><a href="#opening-a-web-page">Opening a Web Page</a></li>
<li class="level1"><a href="#implementing-private-browsing">Implementing Private Browsing</a></li>
<li class="level1"><a href="#managing-downloads">Managing Downloads</a></li>
<li class="level1"><a href="#files-and-attributions">Files and Attributions</a></li>
</ul>
</div>
<div class="sidebar-content" id="sidebar-content"></div></div>
<h1 class="title">WebEngine Widgets Simple Browser Example</h1>
<span class="subtitle"></span>
<!-- $$$webenginewidgets/simplebrowser-brief -->
<p>A simple browser based on Qt WebEngine Widgets.</p>
<!-- @@@webenginewidgets/simplebrowser -->
<!-- $$$webenginewidgets/simplebrowser-description -->
<div class="descr"> <a name="details"></a>
<p class="centerAlign"><img src="images/simplebrowser.png" alt="" /></p><p><i>Simple Browser</i> demonstrates how to use the <a href="qtwebenginewidgets-module.html">Qt WebEngine C++ classes</a> to develop a small Web browser application that contains the following elements:</p>
<ul>
<li>Menu bar for opening stored pages and managing windows and tabs.</li>
<li>Navigation bar for entering a URL and for moving backward and forward in the web page browsing history.</li>
<li>Multi-tab area for displaying web content within tabs.</li>
<li>Status bar for displaying hovered links.</li>
<li>A simple download manager.</li>
</ul>
<p>The web content can be opened in new tabs or separate windows. HTTP and proxy authentication can be used for accessing web pages.</p>
<a name="running-the-example"></a>
<h4 id="running-the-example">Running the Example</h4>
<p>To run the example from <a href="http://doc.qt.io/qtcreator/index.html">Qt Creator</a>, open the <b>Welcome</b> mode and select the example from <b>Examples</b>. For more information, visit <a href="http://doc.qt.io/qtcreator/creator-build-example-application.html">Building and Running an Example</a>.</p>
<a name="class-hierarchy"></a>
<h4 id="class-hierarchy">Class Hierarchy</h4>
<p>We start with sketching a diagram of the main classes that we are going to implement:</p>
<p class="centerAlign"><img src="images/simplebrowser-model.png" alt="" /></p><ul>
<li><code>Browser</code> is a class managing the application windows.</li>
<li><code>BrowserWindow</code> is a <a href="../qtwidgets/qmainwindow.html">QMainWindow</a> showing the menu, a navigation bar, <code>TabWidget</code>, and a status bar.</li>
<li><code>TabWidget</code> is a <a href="../qtwidgets/qtabwidget.html">QTabWidget</a> and contains one or multiple browser tabs.</li>
<li><code>WebView</code> is a <a href="qwebengineview.html">QWebEngineView</a>, provides a view for <code>WebPage</code>, and is added as a tab in <code>TabWidget</code>.</li>
<li><code>WebPage</code> is a <a href="qwebenginepage.html">QWebEnginePage</a> that represents website content.</li>
</ul>
<p>Additionally, we will implement some auxiliary classes:</p>
<ul>
<li><code>WebPopupWindow</code> is a <a href="../qtwidgets/qwidget.html">QWidget</a> for showing popup windows.</li>
<li><code>DownloadManagerWidget</code> is a <a href="../qtwidgets/qwidget.html">QWidget</a> implementing the downloads list.</li>
</ul>
<a name="creating-the-browser-main-window"></a>
<h4 id="creating-the-browser-main-window">Creating the Browser Main Window</h4>
<p>This example supports multiple main windows that are owned by a <code>Browser</code> object. This class also owns the <code>DownloadManagerWidget</code> and could be used for further functionality, such as bookmarks and history managers.</p>
<p>In <code>main.cpp</code>, we create the first <code>BrowserWindow</code> instance and add it to the <code>Browser</code> object. If no arguments are passed on the command line, we open the <a href="http://qt.io/">Qt Homepage</a>:</p>
<pre class="cpp">
 <span class="type">int</span> main(<span class="type">int</span> argc<span class="operator">,</span> <span class="type">char</span> <span class="operator">*</span><span class="operator">*</span>argv)
 {
     <span class="type"><a href="../qtcore/qcoreapplication.html">QCoreApplication</a></span><span class="operator">::</span>setOrganizationName(<span class="string">&quot;QtExamples&quot;</span>);
     <span class="type"><a href="../qtcore/qcoreapplication.html">QCoreApplication</a></span><span class="operator">::</span>setAttribute(<span class="type"><a href="../qtcore/qt.html">Qt</a></span><span class="operator">::</span>AA_EnableHighDpiScaling);
     <span class="type"><a href="../qtcore/qcoreapplication.html">QCoreApplication</a></span><span class="operator">::</span>setAttribute(<span class="type"><a href="../qtcore/qt.html">Qt</a></span><span class="operator">::</span>AA_UseHighDpiPixmaps);

     <span class="type"><a href="../qtwidgets/qapplication.html">QApplication</a></span> app(argc<span class="operator">,</span> argv);
     app<span class="operator">.</span>setWindowIcon(<span class="type"><a href="../qtgui/qicon.html">QIcon</a></span>(<span class="type"><a href="../qtcore/qstring.html#QStringLiteral">QStringLiteral</a></span>(<span class="string">&quot;:AppLogoColor.png&quot;</span>)));

     <span class="type"><a href="qwebenginesettings.html">QWebEngineSettings</a></span><span class="operator">::</span>defaultSettings()<span class="operator">-</span><span class="operator">&gt;</span>setAttribute(<span class="type"><a href="qwebenginesettings.html">QWebEngineSettings</a></span><span class="operator">::</span>PluginsEnabled<span class="operator">,</span> <span class="keyword">true</span>);
 <span class="preprocessor">#if QT_VERSION &gt;= QT_VERSION_CHECK(5, 13, 0)</span>
     <span class="type"><a href="qwebenginesettings.html">QWebEngineSettings</a></span><span class="operator">::</span>defaultSettings()<span class="operator">-</span><span class="operator">&gt;</span>setAttribute(<span class="type"><a href="qwebenginesettings.html">QWebEngineSettings</a></span><span class="operator">::</span>DnsPrefetchEnabled<span class="operator">,</span> <span class="keyword">true</span>);
     <span class="type"><a href="qwebengineprofile.html">QWebEngineProfile</a></span><span class="operator">::</span>defaultProfile()<span class="operator">-</span><span class="operator">&gt;</span>setUseForGlobalCertificateVerification();
 <span class="preprocessor">#endif</span>

     <span class="type"><a href="../qtcore/qurl.html">QUrl</a></span> url <span class="operator">=</span> commandLineUrlArgument();

     Browser browser;
     BrowserWindow <span class="operator">*</span>window <span class="operator">=</span> browser<span class="operator">.</span>createWindow();
     window<span class="operator">-</span><span class="operator">&gt;</span>tabWidget()<span class="operator">-</span><span class="operator">&gt;</span>setUrl(url);

     <span class="keyword">return</span> app<span class="operator">.</span>exec();
 }
</pre>
<a name="creating-tabs"></a>
<h4 id="creating-tabs">Creating Tabs</h4>
<p>The <code>BrowserWindow</code> constructor initializes all the necessary user interface related objects. The <code>centralWidget</code> of <code>BrowserWindow</code> contains an instance of <code>TabWidget</code>. The <code>TabWidget</code> contains one or several <code>WebView</code> instances as tabs, and delegates it's signals and slots to the currently selected one:</p>
<pre class="cpp">
 <span class="keyword">class</span> TabWidget : <span class="keyword">public</span> <span class="type"><a href="../qtwidgets/qtabwidget.html">QTabWidget</a></span>
 {
     ...
 <span class="keyword">signals</span>:
     <span class="comment">// current tab/page signals</span>
     <span class="type">void</span> linkHovered(<span class="keyword">const</span> <span class="type"><a href="../qtcore/qstring.html">QString</a></span> <span class="operator">&amp;</span>link);
     <span class="type">void</span> loadProgress(<span class="type">int</span> progress);
     <span class="type">void</span> titleChanged(<span class="keyword">const</span> <span class="type"><a href="../qtcore/qstring.html">QString</a></span> <span class="operator">&amp;</span>title);
     <span class="type">void</span> urlChanged(<span class="keyword">const</span> <span class="type"><a href="../qtcore/qurl.html">QUrl</a></span> <span class="operator">&amp;</span>url);
     <span class="type">void</span> favIconChanged(<span class="keyword">const</span> <span class="type"><a href="../qtgui/qicon.html">QIcon</a></span> <span class="operator">&amp;</span>icon);
     <span class="type">void</span> webActionEnabledChanged(<span class="type"><a href="qwebenginepage.html">QWebEnginePage</a></span><span class="operator">::</span>WebAction action<span class="operator">,</span> bool enabled);
     <span class="type">void</span> devToolsRequested(<span class="type"><a href="qwebenginepage.html">QWebEnginePage</a></span> <span class="operator">*</span>source);
 <span class="preprocessor">#if QT_VERSION &gt;= QT_VERSION_CHECK(5, 14, 0)</span>
     <span class="type">void</span> findTextFinished(<span class="keyword">const</span> <span class="type"><a href="qwebenginefindtextresult.html">QWebEngineFindTextResult</a></span> <span class="operator">&amp;</span>result);
 <span class="preprocessor">#endif</span>

 <span class="keyword">public</span> <span class="keyword">slots</span>:
     <span class="comment">// current tab/page slots</span>
     <span class="type">void</span> setUrl(<span class="keyword">const</span> <span class="type"><a href="../qtcore/qurl.html">QUrl</a></span> <span class="operator">&amp;</span>url);
     <span class="type">void</span> triggerWebPageAction(<span class="type"><a href="qwebenginepage.html">QWebEnginePage</a></span><span class="operator">::</span>WebAction action);
     ...
 };
</pre>
<p>Each tab contains an instance of <code>WebView</code>:</p>
<pre class="cpp">
 WebView <span class="operator">*</span>TabWidget<span class="operator">::</span>createTab()
 {
     WebView <span class="operator">*</span>webView <span class="operator">=</span> createBackgroundTab();
     setCurrentWidget(webView);
     <span class="keyword">return</span> webView;
 }

 WebView <span class="operator">*</span>TabWidget<span class="operator">::</span>createBackgroundTab()
 {
     WebView <span class="operator">*</span>webView <span class="operator">=</span> <span class="keyword">new</span> WebView;
     WebPage <span class="operator">*</span>webPage <span class="operator">=</span> <span class="keyword">new</span> WebPage(m_profile<span class="operator">,</span> webView);
     webView<span class="operator">-</span><span class="operator">&gt;</span>setPage(webPage);
     setupView(webView);
     <span class="type">int</span> index <span class="operator">=</span> addTab(webView<span class="operator">,</span> tr(<span class="string">&quot;(Untitled)&quot;</span>));
     setTabIcon(index<span class="operator">,</span> webView<span class="operator">-</span><span class="operator">&gt;</span>favIcon());
     <span class="comment">// Workaround for QTBUG-61770</span>
     webView<span class="operator">-</span><span class="operator">&gt;</span>resize(currentWidget()<span class="operator">-</span><span class="operator">&gt;</span>size());
     webView<span class="operator">-</span><span class="operator">&gt;</span>show();
     <span class="keyword">return</span> webView;
 }
</pre>
<p>In <code>TabWidget::setupView()</code>, we make sure that the <code>TabWidget</code> always forwards the signals of the currently selected <code>WebView</code>:</p>
<pre class="cpp">
 <span class="type">void</span> TabWidget<span class="operator">::</span>setupView(WebView <span class="operator">*</span>webView)
 {
     <span class="type"><a href="qwebenginepage.html">QWebEnginePage</a></span> <span class="operator">*</span>webPage <span class="operator">=</span> webView<span class="operator">-</span><span class="operator">&gt;</span>page();

     connect(webView<span class="operator">,</span> <span class="operator">&amp;</span><span class="type"><a href="qwebengineview.html">QWebEngineView</a></span><span class="operator">::</span>titleChanged<span class="operator">,</span> <span class="operator">[</span><span class="keyword">this</span><span class="operator">,</span> webView<span class="operator">]</span>(<span class="keyword">const</span> <span class="type"><a href="../qtcore/qstring.html">QString</a></span> <span class="operator">&amp;</span>title) {
         <span class="type">int</span> index <span class="operator">=</span> indexOf(webView);
         <span class="keyword">if</span> (index <span class="operator">!</span><span class="operator">=</span> <span class="operator">-</span><span class="number">1</span>) {
             setTabText(index<span class="operator">,</span> title);
             setTabToolTip(index<span class="operator">,</span> title);
         }
         <span class="keyword">if</span> (currentIndex() <span class="operator">=</span><span class="operator">=</span> index)
             <span class="keyword">emit</span> titleChanged(title);
     });
     connect(webView<span class="operator">,</span> <span class="operator">&amp;</span><span class="type"><a href="qwebengineview.html">QWebEngineView</a></span><span class="operator">::</span>urlChanged<span class="operator">,</span> <span class="operator">[</span><span class="keyword">this</span><span class="operator">,</span> webView<span class="operator">]</span>(<span class="keyword">const</span> <span class="type"><a href="../qtcore/qurl.html">QUrl</a></span> <span class="operator">&amp;</span>url) {
         <span class="type">int</span> index <span class="operator">=</span> indexOf(webView);
         <span class="keyword">if</span> (index <span class="operator">!</span><span class="operator">=</span> <span class="operator">-</span><span class="number">1</span>)
             tabBar()<span class="operator">-</span><span class="operator">&gt;</span>setTabData(index<span class="operator">,</span> url);
         <span class="keyword">if</span> (currentIndex() <span class="operator">=</span><span class="operator">=</span> index)
             <span class="keyword">emit</span> urlChanged(url);
     });
     connect(webView<span class="operator">,</span> <span class="operator">&amp;</span><span class="type"><a href="qwebengineview.html">QWebEngineView</a></span><span class="operator">::</span>loadProgress<span class="operator">,</span> <span class="operator">[</span><span class="keyword">this</span><span class="operator">,</span> webView<span class="operator">]</span>(<span class="type">int</span> progress) {
         <span class="keyword">if</span> (currentIndex() <span class="operator">=</span><span class="operator">=</span> indexOf(webView))
             <span class="keyword">emit</span> loadProgress(progress);
     });
     connect(webPage<span class="operator">,</span> <span class="operator">&amp;</span><span class="type"><a href="qwebenginepage.html">QWebEnginePage</a></span><span class="operator">::</span>linkHovered<span class="operator">,</span> <span class="operator">[</span><span class="keyword">this</span><span class="operator">,</span> webView<span class="operator">]</span>(<span class="keyword">const</span> <span class="type"><a href="../qtcore/qstring.html">QString</a></span> <span class="operator">&amp;</span>url) {
         <span class="keyword">if</span> (currentIndex() <span class="operator">=</span><span class="operator">=</span> indexOf(webView))
             <span class="keyword">emit</span> linkHovered(url);
     });
     connect(webView<span class="operator">,</span> <span class="operator">&amp;</span>WebView<span class="operator">::</span>favIconChanged<span class="operator">,</span> <span class="operator">[</span><span class="keyword">this</span><span class="operator">,</span> webView<span class="operator">]</span>(<span class="keyword">const</span> <span class="type"><a href="../qtgui/qicon.html">QIcon</a></span> <span class="operator">&amp;</span>icon) {
         <span class="type">int</span> index <span class="operator">=</span> indexOf(webView);
         <span class="keyword">if</span> (index <span class="operator">!</span><span class="operator">=</span> <span class="operator">-</span><span class="number">1</span>)
             setTabIcon(index<span class="operator">,</span> icon);
         <span class="keyword">if</span> (currentIndex() <span class="operator">=</span><span class="operator">=</span> index)
             <span class="keyword">emit</span> favIconChanged(icon);
     });
     connect(webView<span class="operator">,</span> <span class="operator">&amp;</span>WebView<span class="operator">::</span>webActionEnabledChanged<span class="operator">,</span> <span class="operator">[</span><span class="keyword">this</span><span class="operator">,</span> webView<span class="operator">]</span>(<span class="type"><a href="qwebenginepage.html">QWebEnginePage</a></span><span class="operator">::</span>WebAction action<span class="operator">,</span> bool enabled) {
         <span class="keyword">if</span> (currentIndex() <span class="operator">=</span><span class="operator">=</span>  indexOf(webView))
             <span class="keyword">emit</span> webActionEnabledChanged(action<span class="operator">,</span>enabled);
     });
     connect(webPage<span class="operator">,</span> <span class="operator">&amp;</span><span class="type"><a href="qwebenginepage.html">QWebEnginePage</a></span><span class="operator">::</span>windowCloseRequested<span class="operator">,</span> <span class="operator">[</span><span class="keyword">this</span><span class="operator">,</span> webView<span class="operator">]</span>() {
         <span class="type">int</span> index <span class="operator">=</span> indexOf(webView);
         <span class="keyword">if</span> (index <span class="operator">&gt;</span><span class="operator">=</span> <span class="number">0</span>)
             closeTab(index);
     });
     connect(webView<span class="operator">,</span> <span class="operator">&amp;</span>WebView<span class="operator">::</span>devToolsRequested<span class="operator">,</span> <span class="keyword">this</span><span class="operator">,</span> <span class="operator">&amp;</span>TabWidget<span class="operator">::</span>devToolsRequested);
 <span class="preprocessor">#if QT_VERSION &gt;= QT_VERSION_CHECK(5, 14, 0)</span>
     connect(webPage<span class="operator">,</span> <span class="operator">&amp;</span><span class="type"><a href="qwebenginepage.html">QWebEnginePage</a></span><span class="operator">::</span>findTextFinished<span class="operator">,</span> <span class="operator">[</span><span class="keyword">this</span><span class="operator">,</span> webView<span class="operator">]</span>(<span class="keyword">const</span> <span class="type"><a href="qwebenginefindtextresult.html">QWebEngineFindTextResult</a></span> <span class="operator">&amp;</span>result) {
         <span class="keyword">if</span> (currentIndex() <span class="operator">=</span><span class="operator">=</span> indexOf(webView))
             <span class="keyword">emit</span> findTextFinished(result);
     });
 <span class="preprocessor">#endif</span>
 }
</pre>
<a name="implementing-webview-functionality"></a>
<h4 id="implementing-webview-functionality">Implementing WebView Functionality</h4>
<p>The <code>WebView</code> is derived from <a href="qwebengineview.html">QWebEngineView</a> to support the following functionality:</p>
<ul>
<li>Displaying error messages in case <code>renderProcess</code> dies</li>
<li>Handling <code>createWindow</code> requests</li>
<li>Adding custom menu items to context menus</li>
</ul>
<p>First, we create the <a href="../qtwebview/qml-qtwebview-webview.html">WebView</a> with the necessary methods and signals:</p>
<pre class="cpp">
 <span class="keyword">class</span> WebView : <span class="keyword">public</span> <span class="type"><a href="qwebengineview.html">QWebEngineView</a></span>
 {
     Q_OBJECT

 <span class="keyword">public</span>:
     WebView(<span class="type"><a href="../qtwidgets/qwidget.html">QWidget</a></span> <span class="operator">*</span>parent <span class="operator">=</span> nullptr);
     ...
 <span class="keyword">protected</span>:
     <span class="type">void</span> contextMenuEvent(<span class="type"><a href="../qtgui/qcontextmenuevent.html">QContextMenuEvent</a></span> <span class="operator">*</span>event) override;
     <span class="type"><a href="qwebengineview.html">QWebEngineView</a></span> <span class="operator">*</span>createWindow(<span class="type"><a href="qwebenginepage.html">QWebEnginePage</a></span><span class="operator">::</span>WebWindowType type) override;

 <span class="keyword">signals</span>:
     <span class="type">void</span> webActionEnabledChanged(<span class="type"><a href="qwebenginepage.html">QWebEnginePage</a></span><span class="operator">::</span>WebAction webAction<span class="operator">,</span> bool enabled);
     ...
 };
</pre>
<a name="displaying-error-messages"></a>
<h5 id="displaying-error-messages">Displaying Error Messages</h5>
<p>If the render process is terminated, we display a <a href="../qtwidgets/qmessagebox.html">QMessageBox</a> with an error code, and then we reload the page:</p>
<pre class="cpp">
 WebView<span class="operator">::</span>WebView(<span class="type"><a href="../qtwidgets/qwidget.html">QWidget</a></span> <span class="operator">*</span>parent)
     : <span class="type"><a href="qwebengineview.html">QWebEngineView</a></span>(parent)
     <span class="operator">,</span> m_loadProgress(<span class="number">100</span>)
 {
     ...
     connect(<span class="keyword">this</span><span class="operator">,</span> <span class="operator">&amp;</span><span class="type"><a href="qwebengineview.html">QWebEngineView</a></span><span class="operator">::</span>renderProcessTerminated<span class="operator">,</span>
             <span class="operator">[</span><span class="keyword">this</span><span class="operator">]</span>(<span class="type"><a href="qwebenginepage.html">QWebEnginePage</a></span><span class="operator">::</span>RenderProcessTerminationStatus termStatus<span class="operator">,</span> <span class="type">int</span> statusCode) {
         <span class="type"><a href="../qtcore/qstring.html">QString</a></span> status;
         <span class="keyword">switch</span> (termStatus) {
         <span class="keyword">case</span> <span class="type"><a href="qwebenginepage.html">QWebEnginePage</a></span><span class="operator">::</span>NormalTerminationStatus:
             status <span class="operator">=</span> tr(<span class="string">&quot;Render process normal exit&quot;</span>);
             <span class="keyword">break</span>;
         <span class="keyword">case</span> <span class="type"><a href="qwebenginepage.html">QWebEnginePage</a></span><span class="operator">::</span>AbnormalTerminationStatus:
             status <span class="operator">=</span> tr(<span class="string">&quot;Render process abnormal exit&quot;</span>);
             <span class="keyword">break</span>;
         <span class="keyword">case</span> <span class="type"><a href="qwebenginepage.html">QWebEnginePage</a></span><span class="operator">::</span>CrashedTerminationStatus:
             status <span class="operator">=</span> tr(<span class="string">&quot;Render process crashed&quot;</span>);
             <span class="keyword">break</span>;
         <span class="keyword">case</span> <span class="type"><a href="qwebenginepage.html">QWebEnginePage</a></span><span class="operator">::</span>KilledTerminationStatus:
             status <span class="operator">=</span> tr(<span class="string">&quot;Render process killed&quot;</span>);
             <span class="keyword">break</span>;
         }
         <span class="type"><a href="../qtwidgets/qmessagebox.html">QMessageBox</a></span><span class="operator">::</span>StandardButton btn <span class="operator">=</span> <span class="type"><a href="../qtwidgets/qmessagebox.html">QMessageBox</a></span><span class="operator">::</span>question(window()<span class="operator">,</span> status<span class="operator">,</span>
                                                    tr(<span class="string">&quot;Render process exited with code: %1\n&quot;</span>
                                                       <span class="string">&quot;Do you want to reload the page ?&quot;</span>)<span class="operator">.</span>arg(statusCode));
         <span class="keyword">if</span> (btn <span class="operator">=</span><span class="operator">=</span> <span class="type"><a href="../qtwidgets/qmessagebox.html">QMessageBox</a></span><span class="operator">::</span>Yes)
             <span class="type"><a href="../qtcore/qtimer.html">QTimer</a></span><span class="operator">::</span>singleShot(<span class="number">0</span><span class="operator">,</span> <span class="operator">[</span><span class="keyword">this</span><span class="operator">]</span> { reload(); });
     });
 }
</pre>
<a name="managing-webwindows"></a>
<h5 id="managing-webwindows">Managing WebWindows</h5>
<p>The loaded page might want to create windows of the type <a href="qwebenginepage.html#WebWindowType-enum">QWebEnginePage::WebWindowType</a>, for example, when a JavaScript program requests to open a document in a new window or dialog. This is handled by overriding <code>QWebView::createWindow()</code>:</p>
<pre class="cpp">
 <span class="type"><a href="qwebengineview.html">QWebEngineView</a></span> <span class="operator">*</span>WebView<span class="operator">::</span>createWindow(<span class="type"><a href="qwebenginepage.html">QWebEnginePage</a></span><span class="operator">::</span>WebWindowType type)
 {
     BrowserWindow <span class="operator">*</span>mainWindow <span class="operator">=</span> qobject_cast<span class="operator">&lt;</span>BrowserWindow<span class="operator">*</span><span class="operator">&gt;</span>(window());
     <span class="keyword">if</span> (<span class="operator">!</span>mainWindow)
         <span class="keyword">return</span> nullptr;

     <span class="keyword">switch</span> (type) {
     <span class="keyword">case</span> <span class="type"><a href="qwebenginepage.html">QWebEnginePage</a></span><span class="operator">::</span>WebBrowserTab: {
         <span class="keyword">return</span> mainWindow<span class="operator">-</span><span class="operator">&gt;</span>tabWidget()<span class="operator">-</span><span class="operator">&gt;</span>createTab();
     }
</pre>
<p>In case of <code>QWebEnginePage::WebDialog</code>, we create an instance of a custom <code>WebPopupWindow</code> class:</p>
<pre class="cpp">
 <span class="keyword">class</span> WebPopupWindow : <span class="keyword">public</span> <span class="type"><a href="../qtwidgets/qwidget.html">QWidget</a></span>
 {
     Q_OBJECT

 <span class="keyword">public</span>:
     WebPopupWindow(<span class="type"><a href="qwebengineprofile.html">QWebEngineProfile</a></span> <span class="operator">*</span>profile);
     WebView <span class="operator">*</span>view() <span class="keyword">const</span>;

 <span class="keyword">private</span> <span class="keyword">slots</span>:
     <span class="type">void</span> handleGeometryChangeRequested(<span class="keyword">const</span> <span class="type"><a href="../qtcore/qrect.html">QRect</a></span> <span class="operator">&amp;</span>newGeometry);

 <span class="keyword">private</span>:
     <span class="type"><a href="../qtwidgets/qlineedit.html">QLineEdit</a></span> <span class="operator">*</span>m_urlLineEdit;
     <span class="type"><a href="../qtwidgets/qaction.html">QAction</a></span> <span class="operator">*</span>m_favAction;
     WebView <span class="operator">*</span>m_view;
 };
</pre>
<a name="adding-context-menu-items"></a>
<h5 id="adding-context-menu-items">Adding Context Menu Items</h5>
<p>We add a menu item to the context menu, so that users can right-click to have an inspector opened in a new window. We override <a href="qwebengineview.html#contextMenuEvent">QWebEngineView::contextMenuEvent</a> and use <a href="qwebenginepage.html#createStandardContextMenu">QWebEnginePage::createStandardContextMenu</a> to create a default <a href="../qtwidgets/qmenu.html">QMenu</a> with a default list of <a href="qwebenginepage.html#WebAction-enum">QWebEnginePage::WebAction</a> actions.</p>
<p>The default name for <a href="qwebenginepage.html#WebAction-enum">QWebEnginePage::InspectElement</a> action is <b>Inspect</b>. For clarity, we rename it to <b>Open Inspector In New Window</b> when there is no Inspector present yet, and <b>Inspect Element</b> when it's already created.</p>
<p>We also check if the <a href="qwebenginepage.html#WebAction-enum">QWebEnginePage::ViewSource</a> action is in the menu, because if it's not we have to add a separator as well.</p>
<pre class="cpp">
 <span class="type">void</span> WebView<span class="operator">::</span>contextMenuEvent(<span class="type"><a href="../qtgui/qcontextmenuevent.html">QContextMenuEvent</a></span> <span class="operator">*</span>event)
 {
     <span class="type"><a href="../qtwidgets/qmenu.html">QMenu</a></span> <span class="operator">*</span>menu <span class="operator">=</span> page()<span class="operator">-</span><span class="operator">&gt;</span>createStandardContextMenu();
     <span class="keyword">const</span> <span class="type"><a href="../qtcore/qlist.html">QList</a></span><span class="operator">&lt;</span><span class="type"><a href="../qtwidgets/qaction.html">QAction</a></span> <span class="operator">*</span><span class="operator">&gt;</span> actions <span class="operator">=</span> menu<span class="operator">-</span><span class="operator">&gt;</span>actions();
     <span class="keyword">auto</span> inspectElement <span class="operator">=</span> std<span class="operator">::</span>find(actions<span class="operator">.</span>cbegin()<span class="operator">,</span> actions<span class="operator">.</span>cend()<span class="operator">,</span> page()<span class="operator">-</span><span class="operator">&gt;</span>action(<span class="type"><a href="qwebenginepage.html">QWebEnginePage</a></span><span class="operator">::</span>InspectElement));
     <span class="keyword">if</span> (inspectElement <span class="operator">=</span><span class="operator">=</span> actions<span class="operator">.</span>cend()) {
         <span class="keyword">auto</span> viewSource <span class="operator">=</span> std<span class="operator">::</span>find(actions<span class="operator">.</span>cbegin()<span class="operator">,</span> actions<span class="operator">.</span>cend()<span class="operator">,</span> page()<span class="operator">-</span><span class="operator">&gt;</span>action(<span class="type"><a href="qwebenginepage.html">QWebEnginePage</a></span><span class="operator">::</span>ViewSource));
         <span class="keyword">if</span> (viewSource <span class="operator">=</span><span class="operator">=</span> actions<span class="operator">.</span>cend())
             menu<span class="operator">-</span><span class="operator">&gt;</span>addSeparator();

         <span class="type"><a href="../qtwidgets/qaction.html">QAction</a></span> <span class="operator">*</span>action <span class="operator">=</span> <span class="keyword">new</span> <span class="type"><a href="../qtwidgets/qaction.html">QAction</a></span>(menu);
         action<span class="operator">-</span><span class="operator">&gt;</span>setText(<span class="string">&quot;Open inspector in new window&quot;</span>);
         connect(action<span class="operator">,</span> <span class="operator">&amp;</span><span class="type"><a href="../qtwidgets/qaction.html">QAction</a></span><span class="operator">::</span>triggered<span class="operator">,</span> <span class="operator">[</span><span class="keyword">this</span><span class="operator">]</span>() { <span class="keyword">emit</span> devToolsRequested(page()); });

         <span class="type"><a href="../qtwidgets/qaction.html">QAction</a></span> <span class="operator">*</span>before(inspectElement <span class="operator">=</span><span class="operator">=</span> actions<span class="operator">.</span>cend() <span class="operator">?</span> nullptr : <span class="operator">*</span>inspectElement);
         menu<span class="operator">-</span><span class="operator">&gt;</span>insertAction(before<span class="operator">,</span> action);
     } <span class="keyword">else</span> {
         (<span class="operator">*</span>inspectElement)<span class="operator">-</span><span class="operator">&gt;</span>setText(tr(<span class="string">&quot;Inspect element&quot;</span>));
     }
     menu<span class="operator">-</span><span class="operator">&gt;</span>popup(event<span class="operator">-</span><span class="operator">&gt;</span>globalPos());
 }
</pre>
<a name="implementing-webpage-functionality"></a>
<h4 id="implementing-webpage-functionality">Implementing WebPage Functionality</h4>
<p>We implement <code>WebPage</code> as a subclass of <a href="qwebenginepage.html">QWebEnginePage</a> to enable HTTP, proxy authentication, and ignoring SSL certificate errors when accessing web pages:</p>
<pre class="cpp">
 <span class="keyword">class</span> WebPage : <span class="keyword">public</span> <span class="type"><a href="qwebenginepage.html">QWebEnginePage</a></span>
 {
     Q_OBJECT

 <span class="keyword">public</span>:
     WebPage(<span class="type"><a href="qwebengineprofile.html">QWebEngineProfile</a></span> <span class="operator">*</span>profile<span class="operator">,</span> <span class="type"><a href="../qtcore/qobject.html">QObject</a></span> <span class="operator">*</span>parent <span class="operator">=</span> nullptr);

 <span class="keyword">protected</span>:
     bool certificateError(<span class="keyword">const</span> <span class="type"><a href="qwebenginecertificateerror.html">QWebEngineCertificateError</a></span> <span class="operator">&amp;</span>error) override;

 <span class="keyword">private</span> <span class="keyword">slots</span>:
     <span class="type">void</span> handleAuthenticationRequired(<span class="keyword">const</span> <span class="type"><a href="../qtcore/qurl.html">QUrl</a></span> <span class="operator">&amp;</span>requestUrl<span class="operator">,</span> <span class="type"><a href="../qtnetwork/qauthenticator.html">QAuthenticator</a></span> <span class="operator">*</span>auth);
     <span class="type">void</span> handleFeaturePermissionRequested(<span class="keyword">const</span> <span class="type"><a href="../qtcore/qurl.html">QUrl</a></span> <span class="operator">&amp;</span>securityOrigin<span class="operator">,</span> Feature feature);
     <span class="type">void</span> handleProxyAuthenticationRequired(<span class="keyword">const</span> <span class="type"><a href="../qtcore/qurl.html">QUrl</a></span> <span class="operator">&amp;</span>requestUrl<span class="operator">,</span> <span class="type"><a href="../qtnetwork/qauthenticator.html">QAuthenticator</a></span> <span class="operator">*</span>auth<span class="operator">,</span> <span class="keyword">const</span> <span class="type"><a href="../qtcore/qstring.html">QString</a></span> <span class="operator">&amp;</span>proxyHost);
     <span class="type">void</span> handleRegisterProtocolHandlerRequested(<span class="type"><a href="qwebengineregisterprotocolhandlerrequest.html">QWebEngineRegisterProtocolHandlerRequest</a></span> request);
 <span class="preprocessor">#if !defined(QT_NO_SSL) || QT_VERSION &gt;= QT_VERSION_CHECK(5, 12, 0)</span>
     <span class="type">void</span> handleSelectClientCertificate(<span class="type"><a href="qwebengineclientcertificateselection.html">QWebEngineClientCertificateSelection</a></span> clientCertSelection);
 <span class="preprocessor">#endif</span>
 };
</pre>
<p>In all the cases above, we display the appropriate dialog to the user. In case of authentication, we need to set the correct credential values on the <a href="../qtnetwork/qauthenticator.html">QAuthenticator</a> object:</p>
<pre class="cpp">
 <span class="type">void</span> WebPage<span class="operator">::</span>handleAuthenticationRequired(<span class="keyword">const</span> <span class="type"><a href="../qtcore/qurl.html">QUrl</a></span> <span class="operator">&amp;</span>requestUrl<span class="operator">,</span> <span class="type"><a href="../qtnetwork/qauthenticator.html">QAuthenticator</a></span> <span class="operator">*</span>auth)
 {
     <span class="type"><a href="../qtwidgets/qwidget.html">QWidget</a></span> <span class="operator">*</span>mainWindow <span class="operator">=</span> view()<span class="operator">-</span><span class="operator">&gt;</span>window();
     <span class="type"><a href="../qtwidgets/qdialog.html">QDialog</a></span> dialog(mainWindow);
     dialog<span class="operator">.</span>setModal(<span class="keyword">true</span>);
     dialog<span class="operator">.</span>setWindowFlags(dialog<span class="operator">.</span>windowFlags() <span class="operator">&amp;</span> <span class="operator">~</span><span class="type"><a href="../qtcore/qt.html">Qt</a></span><span class="operator">::</span>WindowContextHelpButtonHint);

     Ui<span class="operator">::</span>PasswordDialog passwordDialog;
     passwordDialog<span class="operator">.</span>setupUi(<span class="operator">&amp;</span>dialog);

     passwordDialog<span class="operator">.</span>m_iconLabel<span class="operator">-</span><span class="operator">&gt;</span>setText(<span class="type"><a href="../qtcore/qstring.html">QString</a></span>());
     <span class="type"><a href="../qtgui/qicon.html">QIcon</a></span> icon(mainWindow<span class="operator">-</span><span class="operator">&gt;</span>style()<span class="operator">-</span><span class="operator">&gt;</span>standardIcon(<span class="type"><a href="../qtwidgets/qstyle.html">QStyle</a></span><span class="operator">::</span>SP_MessageBoxQuestion<span class="operator">,</span> <span class="number">0</span><span class="operator">,</span> mainWindow));
     passwordDialog<span class="operator">.</span>m_iconLabel<span class="operator">-</span><span class="operator">&gt;</span>setPixmap(icon<span class="operator">.</span>pixmap(<span class="number">32</span><span class="operator">,</span> <span class="number">32</span>));

     <span class="type"><a href="../qtcore/qstring.html">QString</a></span> introMessage(tr(<span class="string">&quot;Enter username and password for \&quot;%1\&quot; at %2&quot;</span>)
                          <span class="operator">.</span>arg(auth<span class="operator">-</span><span class="operator">&gt;</span>realm())<span class="operator">.</span>arg(requestUrl<span class="operator">.</span>toString()<span class="operator">.</span>toHtmlEscaped()));
     passwordDialog<span class="operator">.</span>m_infoLabel<span class="operator">-</span><span class="operator">&gt;</span>setText(introMessage);
     passwordDialog<span class="operator">.</span>m_infoLabel<span class="operator">-</span><span class="operator">&gt;</span>setWordWrap(<span class="keyword">true</span>);

     <span class="keyword">if</span> (dialog<span class="operator">.</span>exec() <span class="operator">=</span><span class="operator">=</span> <span class="type"><a href="../qtwidgets/qdialog.html">QDialog</a></span><span class="operator">::</span>Accepted) {
         auth<span class="operator">-</span><span class="operator">&gt;</span>setUser(passwordDialog<span class="operator">.</span>m_userNameLineEdit<span class="operator">-</span><span class="operator">&gt;</span>text());
         auth<span class="operator">-</span><span class="operator">&gt;</span>setPassword(passwordDialog<span class="operator">.</span>m_passwordLineEdit<span class="operator">-</span><span class="operator">&gt;</span>text());
     } <span class="keyword">else</span> {
         <span class="comment">// Set authenticator null if dialog is cancelled</span>
         <span class="operator">*</span>auth <span class="operator">=</span> <span class="type"><a href="../qtnetwork/qauthenticator.html">QAuthenticator</a></span>();
     }
 }
</pre>
<p>The <code>handleProxyAuthenticationRequired</code> signal handler implements the very same steps for the authentication of HTTP proxies.</p>
<p>In case of SSL errors, we just need to return a boolean value indicating whether the certificate should be ignored.</p>
<pre class="cpp">
 bool WebPage<span class="operator">::</span>certificateError(<span class="keyword">const</span> <span class="type"><a href="qwebenginecertificateerror.html">QWebEngineCertificateError</a></span> <span class="operator">&amp;</span>error)
 {
     <span class="type"><a href="../qtwidgets/qwidget.html">QWidget</a></span> <span class="operator">*</span>mainWindow <span class="operator">=</span> view()<span class="operator">-</span><span class="operator">&gt;</span>window();

 <span class="preprocessor">#if QT_VERSION &gt;= QT_VERSION_CHECK(5, 14, 0)</span>
     <span class="type"><a href="qwebenginecertificateerror.html">QWebEngineCertificateError</a></span> deferredError <span class="operator">=</span> error;
     deferredError<span class="operator">.</span>defer();

     <span class="type"><a href="../qtcore/qtimer.html">QTimer</a></span><span class="operator">::</span>singleShot(<span class="number">0</span><span class="operator">,</span> mainWindow<span class="operator">,</span> <span class="operator">[</span>mainWindow<span class="operator">,</span> error <span class="operator">=</span> std<span class="operator">::</span>move(deferredError)<span class="operator">]</span> () <span class="keyword">mutable</span> {
         <span class="keyword">if</span> (<span class="operator">!</span>error<span class="operator">.</span>deferred()) {
             <span class="type"><a href="../qtwidgets/qmessagebox.html">QMessageBox</a></span><span class="operator">::</span>critical(mainWindow<span class="operator">,</span> tr(<span class="string">&quot;Certificate Error&quot;</span>)<span class="operator">,</span> error<span class="operator">.</span>errorDescription());
         } <span class="keyword">else</span> {
 <span class="preprocessor">#else</span>
     <span class="keyword">if</span> (error<span class="operator">.</span>isOverridable()) {
 <span class="preprocessor">#endif</span>
             <span class="type"><a href="../qtwidgets/qdialog.html">QDialog</a></span> dialog(mainWindow);
             dialog<span class="operator">.</span>setModal(<span class="keyword">true</span>);
             dialog<span class="operator">.</span>setWindowFlags(dialog<span class="operator">.</span>windowFlags() <span class="operator">&amp;</span> <span class="operator">~</span><span class="type"><a href="../qtcore/qt.html">Qt</a></span><span class="operator">::</span>WindowContextHelpButtonHint);

             Ui<span class="operator">::</span>CertificateErrorDialog certificateDialog;
             certificateDialog<span class="operator">.</span>setupUi(<span class="operator">&amp;</span>dialog);
             certificateDialog<span class="operator">.</span>m_iconLabel<span class="operator">-</span><span class="operator">&gt;</span>setText(<span class="type"><a href="../qtcore/qstring.html">QString</a></span>());
             <span class="type"><a href="../qtgui/qicon.html">QIcon</a></span> icon(mainWindow<span class="operator">-</span><span class="operator">&gt;</span>style()<span class="operator">-</span><span class="operator">&gt;</span>standardIcon(<span class="type"><a href="../qtwidgets/qstyle.html">QStyle</a></span><span class="operator">::</span>SP_MessageBoxWarning<span class="operator">,</span> <span class="number">0</span><span class="operator">,</span> mainWindow));
             certificateDialog<span class="operator">.</span>m_iconLabel<span class="operator">-</span><span class="operator">&gt;</span>setPixmap(icon<span class="operator">.</span>pixmap(<span class="number">32</span><span class="operator">,</span> <span class="number">32</span>));
             certificateDialog<span class="operator">.</span>m_errorLabel<span class="operator">-</span><span class="operator">&gt;</span>setText(error<span class="operator">.</span>errorDescription());
             dialog<span class="operator">.</span>setWindowTitle(tr(<span class="string">&quot;Certificate Error&quot;</span>));

 <span class="preprocessor">#if QT_VERSION &gt;= QT_VERSION_CHECK(5, 14, 0)</span>
             <span class="keyword">if</span> (dialog<span class="operator">.</span>exec() <span class="operator">=</span><span class="operator">=</span> <span class="type"><a href="../qtwidgets/qdialog.html">QDialog</a></span><span class="operator">::</span>Accepted)
                 error<span class="operator">.</span>ignoreCertificateError();
             <span class="keyword">else</span>
                 error<span class="operator">.</span>rejectCertificate();
         }
</pre>
<a name="opening-a-web-page"></a>
<h4 id="opening-a-web-page">Opening a Web Page</h4>
<p>This section describes the workflow for opening a new page. When the user enters a URL in the navigation bar and presses <b>Enter</b>, the <code>QLineEdit::returnPressed</code> signal is emitted and the new URL is then handed over to <code>TabWidget::setUrl</code>:</p>
<pre class="cpp">
 BrowserWindow<span class="operator">::</span>BrowserWindow(Browser <span class="operator">*</span>browser<span class="operator">,</span> <span class="type"><a href="qwebengineprofile.html">QWebEngineProfile</a></span> <span class="operator">*</span>profile<span class="operator">,</span> bool forDevTools)
 {
     ...
         connect(m_urlLineEdit<span class="operator">,</span> <span class="operator">&amp;</span><span class="type"><a href="../qtwidgets/qlineedit.html">QLineEdit</a></span><span class="operator">::</span>returnPressed<span class="operator">,</span> <span class="operator">[</span><span class="keyword">this</span><span class="operator">]</span>() {
             m_tabWidget<span class="operator">-</span><span class="operator">&gt;</span>setUrl(<span class="type"><a href="../qtcore/qurl.html">QUrl</a></span><span class="operator">::</span>fromUserInput(m_urlLineEdit<span class="operator">-</span><span class="operator">&gt;</span>text()));
         });
     ...
 }
</pre>
<p>The call is forwarded to the currently selected tab:</p>
<pre class="cpp">
 <span class="type">void</span> TabWidget<span class="operator">::</span>setUrl(<span class="keyword">const</span> <span class="type"><a href="../qtcore/qurl.html">QUrl</a></span> <span class="operator">&amp;</span>url)
 {
     <span class="keyword">if</span> (WebView <span class="operator">*</span>view <span class="operator">=</span> currentWebView()) {
         view<span class="operator">-</span><span class="operator">&gt;</span>setUrl(url);
         view<span class="operator">-</span><span class="operator">&gt;</span>setFocus();
     }
 }
</pre>
<p>The <code>setUrl()</code> method of <code>WebView</code> just forwards the <code>url</code> to the associated <code>WebPage</code>, which in turn starts the downloading of the page's content in the background.</p>
<a name="implementing-private-browsing"></a>
<h4 id="implementing-private-browsing">Implementing Private Browsing</h4>
<p><i>Private browsing</i>, <i>incognito mode</i>, or <i>off-the-record mode</i> is a feature of many browsers where normally persistent data, such as cookies, the HTTP cache, or browsing history, is kept only in memory, leaving no trace on disk. In this example we will implement private browsing on the window level with tabs in one window all in either normal or private mode. Alternatively we could implement private browsing on the tab-level, with some tabs in a window in normal mode, others in private mode.</p>
<p>Implementing private browsing is quite easy using Qt WebEngine. All one has to do is to create a new <a href="qwebengineprofile.html">QWebEngineProfile</a> and use it in the <a href="qwebenginepage.html">QWebEnginePage</a> instead of the default profile. In the example this new profile is owned by the <code>Browser</code> object:</p>
<pre class="cpp">
 <span class="keyword">class</span> Browser
 {
 <span class="keyword">public</span>:
     ...
     BrowserWindow <span class="operator">*</span>createWindow(bool offTheRecord <span class="operator">=</span> <span class="keyword">false</span>);
 <span class="keyword">private</span>:
     ...
     <span class="type"><a href="../qtcore/qscopedpointer.html">QScopedPointer</a></span><span class="operator">&lt;</span><span class="type"><a href="qwebengineprofile.html">QWebEngineProfile</a></span><span class="operator">&gt;</span> m_otrProfile;
 };
</pre>
<p>Required profile for <i>private browsing</i> is created together with its first window. The default constructor for <a href="qwebengineprofile.html">QWebEngineProfile</a> already puts it in <i>off-the-record</i> mode.</p>
<pre class="cpp">
 BrowserWindow <span class="operator">*</span>Browser<span class="operator">::</span>createWindow(bool offTheRecord)
 {
     <span class="keyword">if</span> (offTheRecord <span class="operator">&amp;</span><span class="operator">&amp;</span> <span class="operator">!</span>m_otrProfile) {
         m_otrProfile<span class="operator">.</span>reset(<span class="keyword">new</span> <span class="type"><a href="qwebengineprofile.html">QWebEngineProfile</a></span>);
     ...
</pre>
<p>All that is left to do is to pass the appropriate profile down to the appropriate <a href="qwebenginepage.html">QWebEnginePage</a> objects. The <code>Browser</code> object will hand to each new <code>BrowserWindow</code> either the global default profile (see <a href="qwebengineprofile.html#defaultProfile">QWebEngineProfile::defaultProfile</a>) or one shared <i>off-the-record</i> profile instance:</p>
<pre class="cpp">
     ...
             m_otrProfile<span class="operator">.</span>get()<span class="operator">,</span> <span class="operator">&amp;</span><span class="type"><a href="qwebengineprofile.html">QWebEngineProfile</a></span><span class="operator">::</span>downloadRequested<span class="operator">,</span>
             <span class="operator">&amp;</span>m_downloadManagerWidget<span class="operator">,</span> <span class="operator">&amp;</span>DownloadManagerWidget<span class="operator">::</span>downloadRequested);
     }
     <span class="keyword">auto</span> profile <span class="operator">=</span> offTheRecord <span class="operator">?</span> m_otrProfile<span class="operator">.</span>get() : <span class="type"><a href="qwebengineprofile.html">QWebEngineProfile</a></span><span class="operator">::</span>defaultProfile();
     <span class="keyword">auto</span> mainWindow <span class="operator">=</span> <span class="keyword">new</span> BrowserWindow(<span class="keyword">this</span><span class="operator">,</span> profile<span class="operator">,</span> <span class="keyword">false</span>);
     <span class="keyword">return</span> mainWindow;
 }
</pre>
<p>The <code>BrowserWindow</code> and <code>TabWidget</code> objects will then ensure that all <a href="qwebenginepage.html">QWebEnginePage</a> objects contained in a window will use this profile.</p>
<a name="managing-downloads"></a>
<h4 id="managing-downloads">Managing Downloads</h4>
<p>Downloads are associated with a <a href="qwebengineprofile.html">QWebEngineProfile</a>. Whenever a download is triggered on a web page the <a href="qwebengineprofile.html#downloadRequested">QWebEngineProfile::downloadRequested</a> signal is emitted with a <a href="qwebenginedownloaditem.html">QWebEngineDownloadItem</a>, which in this example is forwarded to <code>DownloadManagerWidget::downloadRequested</code>:</p>
<pre class="cpp">
 Browser<span class="operator">::</span>Browser()
 {
     <span class="comment">// Quit application if the download manager window is the only remaining window</span>
     m_downloadManagerWidget<span class="operator">.</span>setAttribute(<span class="type"><a href="../qtcore/qt.html">Qt</a></span><span class="operator">::</span>WA_QuitOnClose<span class="operator">,</span> <span class="keyword">false</span>);

     <span class="type"><a href="../qtcore/qobject.html">QObject</a></span><span class="operator">::</span>connect(
         <span class="type"><a href="qwebengineprofile.html">QWebEngineProfile</a></span><span class="operator">::</span>defaultProfile()<span class="operator">,</span> <span class="operator">&amp;</span><span class="type"><a href="qwebengineprofile.html">QWebEngineProfile</a></span><span class="operator">::</span>downloadRequested<span class="operator">,</span>
         <span class="operator">&amp;</span>m_downloadManagerWidget<span class="operator">,</span> <span class="operator">&amp;</span>DownloadManagerWidget<span class="operator">::</span>downloadRequested);
 }
</pre>
<p>This method prompts the user for a file name (with a pre-filled suggestion) and starts the download (unless the user cancels the <b>Save As</b> dialog):</p>
<pre class="cpp">
 <span class="type">void</span> DownloadManagerWidget<span class="operator">::</span>downloadRequested(<span class="type"><a href="qwebenginedownloaditem.html">QWebEngineDownloadItem</a></span> <span class="operator">*</span>download)
 {
     Q_ASSERT(download <span class="operator">&amp;</span><span class="operator">&amp;</span> download<span class="operator">-</span><span class="operator">&gt;</span>state() <span class="operator">=</span><span class="operator">=</span> <span class="type"><a href="qwebenginedownloaditem.html">QWebEngineDownloadItem</a></span><span class="operator">::</span>DownloadRequested);

 <span class="preprocessor">#if QT_VERSION &gt;= QT_VERSION_CHECK(5, 14, 0)</span>
     <span class="type"><a href="../qtcore/qstring.html">QString</a></span> path <span class="operator">=</span> <span class="type"><a href="../qtwidgets/qfiledialog.html">QFileDialog</a></span><span class="operator">::</span>getSaveFileName(<span class="keyword">this</span><span class="operator">,</span> tr(<span class="string">&quot;Save as&quot;</span>)<span class="operator">,</span> <span class="type"><a href="../qtcore/qdir.html">QDir</a></span>(download<span class="operator">-</span><span class="operator">&gt;</span>downloadDirectory())<span class="operator">.</span>filePath(download<span class="operator">-</span><span class="operator">&gt;</span>downloadFileName()));
 <span class="preprocessor">#else</span>
     <span class="type"><a href="../qtcore/qstring.html">QString</a></span> path <span class="operator">=</span> <span class="type"><a href="../qtwidgets/qfiledialog.html">QFileDialog</a></span><span class="operator">::</span>getSaveFileName(<span class="keyword">this</span><span class="operator">,</span> tr(<span class="string">&quot;Save as&quot;</span>)<span class="operator">,</span> download<span class="operator">-</span><span class="operator">&gt;</span>path());
 <span class="preprocessor">#endif</span>
     <span class="keyword">if</span> (path<span class="operator">.</span>isEmpty())
         <span class="keyword">return</span>;

 <span class="preprocessor">#if QT_VERSION &gt;= QT_VERSION_CHECK(5, 14, 0)</span>
     download<span class="operator">-</span><span class="operator">&gt;</span>setDownloadDirectory(<span class="type"><a href="../qtcore/qfileinfo.html">QFileInfo</a></span>(path)<span class="operator">.</span>path());
     download<span class="operator">-</span><span class="operator">&gt;</span>setDownloadFileName(<span class="type"><a href="../qtcore/qfileinfo.html">QFileInfo</a></span>(path)<span class="operator">.</span>fileName());
 <span class="preprocessor">#else</span>
     download<span class="operator">-</span><span class="operator">&gt;</span>setPath(path);
 <span class="preprocessor">#endif</span>
     download<span class="operator">-</span><span class="operator">&gt;</span>accept();
     add(<span class="keyword">new</span> DownloadWidget(download));

     show();
 }
</pre>
<p>The <a href="qwebenginedownloaditem.html">QWebEngineDownloadItem</a> object will periodically emit the <a href="qwebenginedownloaditem.html#downloadProgress">downloadProgress</a> signal to notify potential observers of the download progress and the <a href="qwebenginedownloaditem.html#stateChanged">stateChanged</a> signal when the download is finished or when an error occurs. See <code>downloadmanagerwidget.cpp</code> for an example of how these signals can be handled.</p>
<a name="files-and-attributions"></a>
<h4 id="files-and-attributions">Files and Attributions</h4>
<p>The example uses icons from the Tango Icon Library:</p>
<div class="table"><table class="generic">
 <tr valign="top" class="odd"><td ><a href="qtwebengine-attribution-simplebrowser-tango.html#simplebrowser-tango">Tango Icon Library</a></td><td >Public Domain</td></tr>
</table></div>
<p><a href="https://code.qt.io/cgit/qt/qtwebengine.git/tree/examples/webenginewidgets/simplebrowser?h=5.15">Example project @ code.qt.io</a></p>
</div>
<!-- @@@webenginewidgets/simplebrowser -->
        </div>
       </div>
   </div>
   </div>
</div>
<div class="footer">
   <p>
   <acronym title="Copyright">&copy;</acronym> 2020 The Qt Company Ltd.
   Documentation contributions included herein are the copyrights of
   their respective owners.<br/>    The documentation provided herein is licensed under the terms of the    <a href="http://www.gnu.org/licenses/fdl.html">GNU Free Documentation    License version 1.3</a> as published by the Free Software Foundation.<br/>    Qt and respective logos are trademarks of The Qt Company Ltd.     in Finland and/or other countries worldwide. All other trademarks are property
   of their respective owners. </p>
</div>
</body>
</html>
